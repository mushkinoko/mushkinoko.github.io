<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
    <title>友達のための、YouTube動画埋め込みツール</title>
    <style>
      #videopre {
        margin-top: 8px;
        display: none;
      }
      #copybutton, #closebutton {
        margin-top: 8px;
        margin-right: 8px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>友達のための、YouTube動画埋め込みツール</h1>
      <p>HTMLを書かない友達のために作りました。ブログとかに埋め込むときに便利です。レスポンシブ対応できるようにdivタグで囲っておきました。</p>
      <form id="videourlform" onsubmit="return false">
        <div class="input-group">
          <input type="text" id="videourl" class="form-control" placeholder="動画のURL">
          <span class="input-group-btn">
            <button id="generate" class="btn btn-primary" type="submit">生成</button>
          </span>
        </div>
      </form>
      <pre id="videopre"><code id="videocode"></code></pre>
      <button id="copybutton" class="btn btn-primary">コピーする</button>
      <button id="closebutton" class="btn btn-default">閉じる</button>
    </div>
  </body>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../bootstrap/js/bootstrap.min.js"></script>
  <script>
    $(function(){
      $("#generate").click(function(){
        umekomi($("#videourl").val());
        $("#videopre").css("display", "block");
        $("#copybutton").css("display", "inline");
        $("#closebutton").css("display", "inline");
      });
      $("#closebutton").click(function(){
        $("#videourl").val("");
        $("#videopre").css("display", "none");
        $("#copybutton").css("display", "none");
        $("#closebutton").css("display", "none");
      });
    });
    function umekomi(videourl) {
      var videoid = /[/?=]([-\w]{11})/.exec(videourl);
      if (videoid) {
        videoid = videoid[1];
        $("#videocode").text('<div class="youtube"><iframe width="560" height="315" src="//www.youtube.com/embed/' + videoid + '" frameborder="0" allowfullscreen></iframe></div>');
      }
    }
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById("copybutton").addEventListener("click", function() {
        var range = document.createRange();
        var copytext = document.getElementById("videocode");
        range.selectNode(copytext);
        window.getSelection().addRange(range);
        document.execCommand("copy");
      });
    });
  </script>
</html>
